<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#0a0a0a" />
    <link rel="manifest" href="manifest.json" />
    <title>C√°mara PWA</title>
    <style>
      /* Mobile First Design */
      * { box-sizing: border-box; }
      body { 
        font-family: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; 
        margin: 0; 
        padding: 1rem; 
        background: #fafafa; 
        color: #111; 
        min-height: 100vh;
        font-size: 16px; /* Previene zoom en iOS */
      }
      
      h1 { 
        font-size: 1.5rem; 
        margin: 0 0 1rem 0; 
        text-align: center;
      }
      
      .controls { 
        display: flex; 
        flex-direction: column; 
        gap: 0.75rem; 
        margin-bottom: 1rem; 
      }
      
      #switchCamera {
        background: #17a2b8;
        order: 1; /* Posicionar entre "Abrir" y "Tomar" */
      }
      
      #switchCamera:hover { background: #138496; }
      
      #takePhoto { order: 2; }
      #downloadLink { order: 3; }
      
      button, .nav-button { 
        padding: 0.875rem 1rem; 
        font-size: 1rem; 
        border: none; 
        border-radius: 8px; 
        cursor: pointer; 
        font-weight: 500;
        min-height: 44px; /* iOS touch target minimum */
        background: #007acc;
        color: white;
        transition: background-color 0.2s;
      }
      
      button:hover, .nav-button:hover { background: #005a9e; }
      button:disabled { background: #ccc; cursor: not-allowed; }
      
      #cameraContainer { 
        display: none; 
        margin-bottom: 1rem; 
        text-align: center;
      }
      
      video { 
        width: 100%; 
        max-width: 100%; 
        height: auto; 
        background: #000; 
        border-radius: 8px;
        aspect-ratio: 4/3; /* Mantiene proporci√≥n consistente */
      }
      
      canvas { 
        display: none; 
        width: 100%; 
        max-width: 100%; 
        margin-top: 1rem; 
        border: 1px solid #ddd; 
        border-radius: 8px;
      }
      
      #downloadLink {
        display: none;
        padding: 0.875rem 1rem;
        background: #28a745;
        color: white;
        text-decoration: none;
        border-radius: 8px;
        font-weight: 500;
        text-align: center;
        min-height: 44px;
        line-height: 1.2;
      }
      
      /* Galer√≠a de fotos - Mobile Optimized */
      .gallery-section { 
        margin-top: 1.5rem; 
        border-top: 2px solid #ddd; 
        padding-top: 1rem; 
      }
      
      .gallery-section h2 { 
        font-size: 1.25rem; 
        margin: 0 0 1rem 0; 
        text-align: center;
      }
      
      .gallery-container { 
        display: none; 
        position: relative; 
        width: 100%;
      }
      
      .gallery-photo { 
        width: 100%; 
        height: auto; 
        border: 2px solid #ccc; 
        border-radius: 12px; 
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      }
      
      .gallery-nav { 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        margin: 1rem 0; 
        gap: 0.5rem;
      }
      
      .nav-button { 
        flex: 1; 
        max-width: 120px;
        font-size: 0.875rem;
        padding: 0.75rem 0.5rem;
      }
      
      .photo-counter { 
        font-size: 1rem; 
        color: #666; 
        font-weight: 500;
        text-align: center;
        min-width: 60px;
      }
      
      .gallery-actions { 
        display: flex; 
        flex-direction: column;
        gap: 0.75rem; 
        margin-top: 1rem; 
      }
      
      .delete-button { 
        background: #dc3545; 
        color: white; 
        border: none; 
        padding: 0.875rem 1rem; 
        border-radius: 8px; 
        cursor: pointer; 
        font-size: 1rem;
        font-weight: 500;
        min-height: 44px;
      }
      
      .delete-button:hover { background: #c82333; }
      
      #emptyGallery {
        color: #888; 
        font-style: italic;
        text-align: center;
        padding: 2rem 1rem;
        font-size: 1rem;
      }
      
      /* Tablet y Desktop - Progressive Enhancement */
      @media (min-width: 768px) {
        body { padding: 2rem; }
        
        h1 { font-size: 2rem; }
        
        .controls { 
          flex-direction: row; 
          justify-content: center; 
        }
        
        button, .nav-button { 
          flex: none; 
          min-width: 140px; 
        }
        
        video, canvas, .gallery-photo { 
          max-width: 480px; 
          margin: 0 auto; 
          display: block;
        }
        
        .gallery-nav { 
          max-width: 480px; 
          margin: 1rem auto; 
        }
        
        .gallery-actions { 
          flex-direction: row; 
          max-width: 480px; 
          margin: 1rem auto; 
        }
        
        .delete-button { flex: 1; }
        #downloadCurrent { flex: 1; text-align: center; }
      }
      
      /* Landscape orientation adjustments */
      @media (orientation: landscape) and (max-height: 600px) {
        h1 { font-size: 1.25rem; margin-bottom: 0.5rem; }
        body { padding: 0.5rem; }
        .gallery-section { margin-top: 1rem; }
      }
    </style>
  </head>
  <body>
    <h1>C√°mara PWA</h1>

    <div class="controls">
      <button id="openCamera">üì± Abrir C√°mara</button>
      <button id="switchCamera" style="display:none;">üîÑ Cambiar C√°mara</button>
      <button id="takePhoto" disabled>üì∏ Tomar Foto</button>
      <a id="downloadLink" download="foto.png">üíæ Descargar Foto</a>
    </div>

    <div id="cameraContainer">
      <video id="video" autoplay playsinline></video>
    </div>

    <canvas id="canvas" width="320" height="240"></canvas>

    <!-- Galer√≠a de fotos -->
    <div class="gallery-section">
      <h2>Galer√≠a de Fotos (M√°ximo 3)</h2>
      <div id="galleryContainer" class="gallery-container">
        <img id="galleryPhoto" class="gallery-photo" src="" alt="Foto de la galer√≠a" />
        <div class="gallery-nav">
          <button id="prevPhoto" class="nav-button">‚Üê Anterior</button>
          <span id="photoCounter" class="photo-counter">0 / 0</span>
          <button id="nextPhoto" class="nav-button">Siguiente ‚Üí</button>
        </div>
        <div class="gallery-actions">
          <button id="deletePhoto" class="delete-button">üóëÔ∏è Limpiar Galer√≠a</button>
          <a id="downloadCurrent" class="nav-button" download="foto-galeria.png">üíæ Descargar</a>
        </div>
      </div>
      <p id="emptyGallery" style="color: #888; font-style: italic;">No hay fotos guardadas</p>
    </div>

    <script src="app.js"></script>
  </body>
</html>